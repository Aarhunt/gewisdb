<?php
use Database\Model\Member;
use Database\Model\Address;
?>
<?php if (isset($form)): ?>
<?php
$form->prepare();

$form->setAttribute('action', $this->url('member/default', array('action' => 'subscribe')));
$form->setAttribute('method', 'post');

$form->setAttribute('role', 'form');
$form->setAttribute('class', 'form-horizontal');
?>
<?= $this->form()->openTag($form) ?>

<div class="jumbotron">
<div class="row">
<div class="col-md-3">
<img src="<?= $this->basePath() ?>/img/gewis.png" />
</div>
<div class="col-md-9">
<h1><?= $this->translate('Inschrijving Studievereniging <span class="gewis-red">GEWIS</span>') ?></h1>
<p>
<?= $this->translate('Welkom! Met dit formulier kun je inschrijven voor een lidmaatschap van GEWIS.
Het lidmaatschap is geldig zo lang je studeert en kost eenmalig 15 euro.') ?>
</p>
</div>
</div>
</div>

<div class="row">

<?php if (count($form->getMessages()) > 0): ?>
<div class="alert alert-danger" role="alert">
<?= $this->translate('Er zijn velden fout of niet ingevuld. Los dit op en stuur opnieuw in!') ?>
</div>
<?php endif ?>

<?php
$element = $form->get('lastName');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('middleName');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('initials');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('firstName');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('gender');
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?php foreach ($element->getValueOptions() as $option => $text): ?>
            <div class="radio">
                <label>
                <input type="radio" name="<?= $element->getName() ?>" id="<?= $element->getName() ?>" value="<?= $option ?>" <?= $element->getValue() == $option ? 'checked' : '' ?>>
                    <?= $text ?>
                </label>
            </div>
        <?php endforeach ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('tuenumber');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('study');
$element->setAttribute('class', 'form-control');
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formSelect($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('email');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $form->get('birth');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<h3><?= $this->translate('Thuisadres (adres van je ouders)') ?></h3>
<fieldset>
<?php
$fs = $form->get('homeAddress');
?>
<?= $this->formHidden($fs->get('type')) ?>

<?php
$element = $fs->get('country');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('street');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('number');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('postalCode');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('city');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('phone');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>
</fieldset>

<button class="btn btn-primary" type="button" data-toggle="collapse" data-target=".study-address" aria-expanded="true" aria-controls="study-address">
<?= $this->translate('Ik heb geen kamer') ?></button>
<fieldset class="study-address in">
<h3><?= $this->translate('Studieadres (adres kamer)') ?></h3>
<?php
$fs = $form->get('studentAddress');
?>
<?= $this->formHidden($fs->get('type')) ?>

<?php
$element = $fs->get('country');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('street');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('number');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('postalCode');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('city');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>

<?php
$element = $fs->get('phone');
$element->setAttribute('class', 'form-control');
$element->setAttribute('placeholder', $element->getLabel());
$element->setLabelAttributes(array(
    'class' => 'col-sm-2 control-label'
));
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <?= $this->formLabel($element) ?>
    <div class="col-sm-10">
        <?= $this->formInput($element) ?>
        <?= $this->formElementErrors($element) ?>
    </div>
</div>
</fieldset>

<h3><?= $this->translate('Mailinglijsten') ?></h3>
<p>
<?= $this->translate('Als GEWIS-lid word je ingeschreven op de GEWIS-lijst. Deze is voor mededelingen
en activiteiten van de studievereniging. Daarnaast zijn er verschillende
optionele mailinglijsten.
Voor de volgende mailinglijsten kun je je eventueel aanmelden. Deze
inschrijvingen kunnen op een later tijdstip veranderd worden.') ?>
</p>

<?php foreach ($form->getLists() as $list): ?>
<div class="form-group">
    <?php
    $element = $form->get('list-' . $list->getName());
    $element->setAttribute('placeholder', $element->getLabel());
    ?>
    <div class="col-sm-offset-1 col-sm-8">
        <div class="checkbox">
            <label>
                <?= $this->formCheckbox($element) ?>
                <?= $element->getLabel() ?>
            </label>
            <?= $this->formElementErrors($element) ?>
        </div>
    </div>
</div>
<?php endforeach ?>

<h3><?= $this->translate('Akkoordverklaring') ?></h3>

<a href="https://gewis.nl/vereniging/statuten/index.php"><?= $this->translate('Statuten en HR') ?></a>

<?php
$element = $form->get('agreed');
$element->setAttribute('placeholder', $element->getLabel());
?>
<div class="form-group<?= count($element->getMessages()) > 0 ? ' has-error' : '' ?>">
    <div class="col-sm-offset-1 col-sm-8">
        <div class="checkbox">
            <label>
                <?= $this->formCheckbox($element) ?>
<?= $this->translate('Ik verklaar hierbij het formulier geheel naar waarheid te hebben ingevuld, en
ga akkoord met lidmaatschap van Studievereniging GEWIS. Ik heb de statuten en
HR gelezen.') ?>
                <?= $element->getLabel() ?>
            </label>
            <?= $this->formElementErrors($element) ?>
        </div>
    </div>
</div>

<div class="form-group">
    <div class="col-sm-offset-2 col-sm-10">
        <?php
        $submit = $form->get('submit');
        $submit->setLabel($submit->getValue());
        $submit->setAttribute('class', 'btn btn-primary');
        ?>
        <?= $this->formButton($submit) ?>
    </div>
</div>

<?= $this->form()->closeTag() ?>
</div>
<?php else: ?>
    <h1 class="hidden-print"><?= $this->translate('Gefeliciteerd! Je bent geregistreed als lid van Studievereniging GEWIS') ?>
        <small><?= $this->translate('Na betaling van je lidmaatschapsgeld ben je GEWIS-lid!') ?></small></h1>
    <h2 class="hidden-print">Hier nogmaals je gegevens ter controle <small>Print ook deze pagina</small></h2>
<div class="row">
<div class="col-md-6">
    <h1><?= $member->getFullName() ?></h1>
    <table class="table table-bordered">
        <tr>
            <th>Lidnummer</th>
            <td><?= $member->getLidnr() ?></td>
        </tr>
        <tr>
            <th>Voorletters</th>
            <td><?= $member->getInitials() ?></td>
        </tr>
        <tr>
            <th>Voornaam</th>
            <td><?= $member->getFirstName() ?></td>
        </tr>
        <tr>
            <th>Tussenvoegsels</th>
            <td><?= $member->getMiddleName() ?></td>
        </tr>
        <tr>
            <th>Achternaam</th>
            <td><?= $member->getLastName() ?></td>
        </tr>
        <tr>
            <th>Geslacht</th>
            <td><?php
switch ($member->getGender()) {
case Member::GENDER_MALE:
    echo 'Man';
    break;
case Member::GENDER_FEMALE:
    echo 'Vrouw';
    break;
case Member::GENDER_OTHER:
    echo 'Anders';
    break;
}
?></td>
        </tr>
        <tr>
            <th>TU/e nummer</th>
            <td><?= $member->getTuenumber() ?></td>
        </tr>
        <tr>
            <th>Studie</th>
            <td><?= $member->getStudy() ?></td>
        </tr>
        <tr>
            <th>Email</th>
            <td><a href="mailto:<?= $member->getEmail() ?>"><?= $member->getEmail() ?></a></td>
        </tr>
        <tr>
            <th>Geboortedatum</th>
            <td><?= $member->getBirth()->format('l j F Y') ?></td>
        </tr>
        <tr>
            <th>Generatie</th>
            <td><?= $member->getGeneration() ?></td>
        </tr>
        <tr>
            <th>Betaald (hoe veel)</th>
            <td><?= $member->getPaid() ?></td>
        </tr>
        <tr>
            <th>Type lid</th>
            <td><?php
switch ($member->getType()) {
case Member::TYPE_ORDINARY:
    echo 'Gewoon';
    break;
case Member::TYPE_PROLONGED:
    echo 'Verlengd';
    break;
case Member::TYPE_EXTERNAL:
    echo 'Extern';
    break;
case Member::TYPE_EXTRAORDINARY:
    echo 'Buitengewoon';
    break;
case Member::TYPE_HONORARY:
    echo 'Erelid';
    break;
}
?></td>
        </tr>
        <tr>
            <th>Laatste wijziging lidmaatshap</th>
            <td><?= $member->getChangedOn()->format('l j F Y') ?></td>
        </tr>
        <tr>
            <th>Verloopdatum lidmaatschap</th>
            <td><?= $member->getExpiration()->format('l j F Y') ?></td>
        </tr>
    </table>
</div>
<div class="col-md-6">
<h3>Adressen</h3>
<?php $addresses = array() ?>
<?php foreach ($member->getAddresses() as $address): ?>
<?php $addresses[$address->getType()] = $address ?>
<h4><?php
switch ($address->getType()) {
case Address::TYPE_HOME:
    echo 'Thuisadres (ouders)';
    break;
case Address::TYPE_STUDENT:
    echo 'Kameradres';
    break;
case Address::TYPE_MAIL:
    echo 'Postadres';
    break;
}
?></h4>
<table class="table table-bordered">
    <tr>
        <th>Land</th>
        <td><?= $address->getCountry() ?></td>
    </tr>
    <tr>
        <th>Straat en huisnummer</th>
        <td><?= $address->getStreet() ?> <?= $address->getNumber() ?></td>
    </tr>
    <tr>
        <th>Woonplaats en Postcode</th>
        <td><?= $address->getCity() ?> <?= $address->getPostalCode() ?></td>
    </tr>
    <tr>
        <th>Telefoonnummer</th>
        <td><?= $address->getPhone() ?></td>
    </tr>
</table>
<?php endforeach ?>
<h3>Aangemelde mailing lists</h3>
<ul>
<?php foreach ($member->getLists() as $list): ?>
    <li><?= $list->getName() ?></li>
<?php endforeach ?>
</ul>
</div>
</div>
<?php endif ?>
